<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="BDProject.Views.HomePage"
             xmlns:local="clr-namespace:BDProject.ViewModels">
    
    <ContentPage.Content>

        <Grid RowDefinitions="auto,*">

            <Grid 
                Grid.Row="0"
                Padding="8,0"
                ColumnDefinitions="*,auto">

                <Entry
                    Grid.Column="0"
                    Text="{Binding Search}"
                    Placeholder="Search" />

                <Button 
                    Grid.Column="1"
                    HeightRequest="46"
                    WidthRequest="58"
                    Text=""
                    FontSize="Large"
                    FontFamily="FA-S"/>

            </Grid>

            <RefreshView 
                Grid.Row="1"
                IsRefreshing="{Binding IsRefreshing}"
                Command="{Binding RefreshCommand}">

                <CollectionView 
                    SelectionMode="None"
                    x:Name="PostsCollectionView"
                    ItemsSource="{Binding PostsCollection}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>

                            <Grid 
                                Padding="8,16"
                                RowDefinitions="auto,*,auto">

                                <StackLayout
                                    Grid.Row="0"
                                    Orientation="Horizontal">

                                    <Frame
                                        HeightRequest="30"
                                        WidthRequest="30"
                                        CornerRadius="100"
                                        Padding="0"
                                        IsClippedToBounds="True">
                                        
                                        <ImageButton 
                                            HorizontalOptions="Center"
                                            VerticalOptions="Center"
                                            Scale="1.4"
                                            Source="{Binding UserPhotoSource}"/>
                                        
                                    </Frame>
                                    
                                    <Label 
                                        VerticalOptions="Center"
                                        FontSize="Medium"
                                        FontAttributes="Bold"
                                        TextColor="{StaticResource Black}"
                                        Text="{Binding Username}" />

                                </StackLayout>

                                <Grid
                                    Grid.Row="1"
                                    ColumnDefinitions="*,auto">

                                    <Image 
                                        Grid.Column="0"
                                        Source="{Binding PhotoSource}"/>
                                    <!--<Button
                                        HeightRequest="200"
                                        Grid.Column="0"
                                        Text="Post"/> -->

                                    <StackLayout
                                        VerticalOptions="Center"
                                        HorizontalOptions="Center"
                                        Grid.Column="1"
                                        Orientation="Vertical">

                                        <Button 
                                            HeightRequest="46"
                                            WidthRequest="46"
                                            Text=""
                                            FontSize="Large"
                                            FontFamily="FA-R"
                                            BackgroundColor="{StaticResource White}"
                                            Command="{Binding LikePostItemCommand, Source={
                                                RelativeSource AncestorType={x:Type local:HomePageViewModel}
                                            }}"
                                            CommandParameter="{Binding .}"/>

                                        <Label 
                                            FontSize="Large"
                                            HorizontalOptions="Center"
                                            TextColor="{StaticResource Black}"
                                            Text="{Binding LikesCount, Source={
                                                RelativeSource AncestorType={x:Type local:HomePageViewModel}
                                            }}" />

                                        <Button 
                                            HeightRequest="46"
                                            WidthRequest="46"
                                            Text="" 
                                            FontSize="Large"
                                            FontFamily="FA-R"
                                            BackgroundColor="{StaticResource White}"
                                            Command="{Binding OpenPostCommentsItemCommand, Source={
                                                RelativeSource AncestorType={x:Type local:HomePageViewModel}
                                            }}"
                                            CommandParameter="{Binding .}"/>

                                        <Label 
                                            FontSize="Large"
                                            HorizontalOptions="Center"
                                            TextColor="{StaticResource Black}"
                                            Text="{Binding CommentsCount, Source={
                                                RelativeSource AncestorType={x:Type local:HomePageViewModel}
                                            }}" />

                                    </StackLayout>

                                </Grid>

                                <StackLayout
                                    Grid.Row="2"
                                    Orientation="Vertical">

                                    <!--<Label 
                                        FontSize="Medium"
                                        FontAttributes="Bold"
                                        TextColor="{StaticResource Black}"
                                        Text="{Binding Username}" />-->

                                    <Label 
                                        FontSize="Medium"
                                        TextColor="{StaticResource Black}"
                                        Text="{Binding Description}" />

                                </StackLayout>

                            </Grid>

                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

            </RefreshView>

        </Grid>
        
    </ContentPage.Content>
</ContentPage>